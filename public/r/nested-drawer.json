{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "nested-drawer",
  "title": "Nested Menu Drawer",
  "description": "A fully accessible, animated drawer component with nested navigation support and smooth transitions.",
  "dependencies": [
    "motion"
  ],
  "files": [
    {
      "path": "registry/new-york/blocks/nested-drawer/page.tsx",
      "content": "\"use client\";\n\nimport {\n  NestedDrawer,\n  TMenuItem,\n} from \"@/registry/new-york/blocks/nested-drawer/components/nested-drawer\";\nimport {\n  BookOpen,\n  Briefcase,\n  Building2,\n  HelpCircle,\n  Home as HomeIcon,\n  Mail,\n  Package,\n  Server,\n  Shield,\n  Users,\n} from \"lucide-react\";\n\nconst MENU_DATA: TMenuItem[] = [\n  {\n    id: \"home\",\n    title: \"Home\",\n    description: \"Welcome to our platform\",\n    icon: <HomeIcon className=\"size-5\" />,\n    onClick: () => console.log(\"Home clicked\"),\n  },\n  {\n    id: \"products\",\n    title: \"Products & Services\",\n    description: \"Explore our offerings\",\n    icon: <Package className=\"size-5\" />,\n    children: [\n      {\n        id: \"products-software\",\n        title: \"Software Solutions\",\n        description: \"Enterprise and custom software\",\n        icon: <Server className=\"size-5\" />,\n        onClick: () => console.log(\"Software clicked\"),\n      },\n      {\n        id: \"products-cloud\",\n        title: \"Cloud Services\",\n        description: \"Scalable cloud infrastructure\",\n        icon: <Shield className=\"size-5\" />,\n        onClick: () => console.log(\"Cloud clicked\"),\n      },\n    ],\n  },\n  {\n    id: \"company\",\n    title: \"Company\",\n    description: \"Learn about our organization\",\n    icon: <Users className=\"size-5\" />,\n    children: [\n      {\n        id: \"company-about\",\n        title: \"About Us\",\n        description: \"Our story and mission\",\n        icon: <Building2 className=\"size-5\" />,\n        onClick: () => console.log(\"About Us clicked\"),\n      },\n      {\n        id: \"company-careers\",\n        title: \"Careers\",\n        description: \"Join our team\",\n        icon: <Briefcase className=\"size-5\" />,\n        onClick: () => console.log(\"Careers clicked\"),\n      },\n    ],\n  },\n  {\n    id: \"resources\",\n    title: \"Resources\",\n    description: \"Knowledge base and materials\",\n    icon: <BookOpen className=\"size-5\" />,\n    onClick: () => console.log(\"Resources clicked\"),\n  },\n  {\n    id: \"support\",\n    title: \"Support\",\n    description: \"Get help when you need it\",\n    icon: <HelpCircle className=\"size-5\" />,\n    onClick: () => console.log(\"Support clicked\"),\n  },\n  {\n    id: \"contact\",\n    title: \"Contact\",\n    description: \"Get in touch with our team\",\n    icon: <Mail className=\"size-5\" />,\n    onClick: () => console.log(\"Contact clicked\"),\n  },\n];\n\nexport default function NestedDrawerExample() {\n  return (\n    <NestedDrawer initialMenu={MENU_DATA}>\n      <NestedDrawer.Trigger>\n        <span>Open Menu</span>\n      </NestedDrawer.Trigger>\n      <NestedDrawer.Content title=\"Main Menu\">\n        <NestedDrawer.Menu />\n      </NestedDrawer.Content>\n    </NestedDrawer>\n  );\n}\n",
      "type": "registry:component"
    },
    {
      "path": "registry/new-york/blocks/nested-drawer/components/nested-drawer.tsx",
      "content": "\"use client\";\n\nimport { motion, AnimatePresence } from \"motion/react\";\nimport * as React from \"react\";\nimport { ChevronRight, ChevronLeft } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\nconst ANIMATION_DURATION = 0.4;\nconst EASING = [0.32, 0.72, 0, 1] as const;\n\nexport type TMenuItem = {\n  id: string;\n  title: string;\n  description?: string;\n  icon?: React.ReactNode;\n  children?: TMenuItem[];\n  onClick?: () => void;\n};\n\ntype TNestedDrawerContext = {\n  menuStack: TMenuItem[][];\n  currentMenu: TMenuItem[];\n  direction: \"forward\" | \"backward\";\n  navigateToMenu: (items: TMenuItem[]) => void;\n  navigateBack: () => void;\n  canGoBack: boolean;\n  open: boolean;\n  setOpen: (open: boolean) => void;\n};\n\nconst NestedDrawerContext = React.createContext<\n  TNestedDrawerContext | undefined\n>(undefined);\n\nconst useNestedDrawer = () => {\n  const context = React.useContext(NestedDrawerContext);\n  if (!context) {\n    throw new Error(\n      \"NestedDrawer compound components must be used within NestedDrawer\"\n    );\n  }\n  return context;\n};\n\ntype TNestedDrawerProps = {\n  children: React.ReactNode;\n  initialMenu: TMenuItem[];\n};\n\nexport function NestedDrawer({ children, initialMenu }: TNestedDrawerProps) {\n  const [open, setOpen] = React.useState(false);\n  const [menuStack, setMenuStack] = React.useState<TMenuItem[][]>([\n    initialMenu,\n  ]);\n  const [direction, setDirection] = React.useState<\"forward\" | \"backward\">(\n    \"forward\"\n  );\n\n  const currentMenu = menuStack[menuStack.length - 1];\n  const canGoBack = menuStack.length > 1;\n\n  const navigateToMenu = React.useCallback((items: TMenuItem[]) => {\n    setDirection(\"forward\");\n    setMenuStack((prev) => [...prev, items]);\n  }, []);\n\n  const navigateBack = React.useCallback(() => {\n    if (menuStack.length > 1) {\n      setDirection(\"backward\");\n      setMenuStack((prev) => prev.slice(0, -1));\n    }\n  }, [menuStack.length]);\n\n  React.useEffect(() => {\n    if (!open) {\n      const timeout = setTimeout(() => {\n        setMenuStack([initialMenu]);\n        setDirection(\"forward\");\n      }, ANIMATION_DURATION * 1000);\n      return () => clearTimeout(timeout);\n    }\n  }, [open, initialMenu]);\n\n  return (\n    <NestedDrawerContext.Provider\n      value={{\n        menuStack,\n        currentMenu,\n        direction,\n        navigateToMenu,\n        navigateBack,\n        canGoBack,\n        open,\n        setOpen,\n      }}\n    >\n      {children}\n    </NestedDrawerContext.Provider>\n  );\n}\n\ntype TTriggerProps = React.ButtonHTMLAttributes<HTMLButtonElement> & {\n  children: React.ReactNode;\n};\n\nfunction Trigger({ children, className, ...props }: TTriggerProps) {\n  const { setOpen } = useNestedDrawer();\n\n  return (\n    <button\n      type=\"button\"\n      className={cn(\n        \"relative flex h-10 shrink-0 items-center justify-center gap-2 overflow-hidden rounded-full bg-card px-4 text-sm font-medium shadow-sm transition-all hover:bg-accent border cursor-pointer\",\n        className\n      )}\n      onClick={() => setOpen(true)}\n      aria-label=\"Open menu drawer\"\n      {...props}\n    >\n      {children}\n    </button>\n  );\n}\n\ntype TContentProps = {\n  title?: string;\n  children?: React.ReactNode;\n};\n\nfunction Content({ title, children }: TContentProps) {\n  const { open, setOpen, canGoBack, navigateBack, currentMenu } =\n    useNestedDrawer();\n  const contentRef = React.useRef<HTMLDivElement>(null);\n  const innerRef = React.useRef<HTMLDivElement>(null);\n  const [height, setHeight] = React.useState<number | \"auto\">(\"auto\");\n\n  React.useEffect(() => {\n    if (open && contentRef.current) {\n      const firstFocusable = contentRef.current.querySelector<HTMLElement>(\n        'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n      );\n      firstFocusable?.focus();\n    }\n  }, [open]);\n\n  React.useEffect(() => {\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\" && open) {\n        setOpen(false);\n      }\n    };\n\n    document.addEventListener(\"keydown\", handleEscape);\n    return () => document.removeEventListener(\"keydown\", handleEscape);\n  }, [open, setOpen]);\n\n  React.useEffect(() => {\n    if (!innerRef.current) return;\n\n    const measureHeight = () => {\n      if (innerRef.current) {\n        const newHeight = innerRef.current.offsetHeight;\n        setHeight(newHeight);\n      }\n    };\n\n    measureHeight();\n\n    const resizeObserver = new ResizeObserver(measureHeight);\n    resizeObserver.observe(innerRef.current);\n\n    return () => {\n      resizeObserver.disconnect();\n    };\n  }, [currentMenu, canGoBack]);\n\n  return (\n    <>\n      <AnimatePresence>\n        {open && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            transition={{ duration: ANIMATION_DURATION, ease: EASING }}\n            className=\"fixed -inset-8 bg-black/40 z-50 backdrop-blur-sm cursor-pointer\"\n            onClick={() => setOpen(false)}\n            aria-hidden=\"true\"\n          />\n        )}\n      </AnimatePresence>\n\n      <AnimatePresence>\n        {open && (\n          <motion.div\n            ref={contentRef}\n            initial={{ y: \"calc(100% + 1rem)\" }}\n            animate={{ y: 0 }}\n            exit={{ y: \"calc(100% + 1rem)\" }}\n            transition={{ duration: ANIMATION_DURATION, ease: EASING }}\n            className=\"fixed inset-x-0 bottom-4 z-50 mx-auto max-w-lg px-4\"\n            role=\"dialog\"\n            aria-modal=\"true\"\n            aria-label={title || \"Menu drawer\"}\n          >\n            <motion.div\n              animate={{ height }}\n              transition={{\n                duration: ANIMATION_DURATION,\n                ease: EASING,\n              }}\n              className=\"bg-card border rounded-2xl shadow-xl max-h-[85vh] overflow-hidden\"\n            >\n              <div ref={innerRef}>\n                {canGoBack && (\n                  <motion.div\n                    initial={{ opacity: 0 }}\n                    animate={{ opacity: 1 }}\n                    exit={{ opacity: 0 }}\n                    transition={{\n                      opacity: {\n                        duration: ANIMATION_DURATION * 0.6,\n                        ease: EASING,\n                      },\n                    }}\n                    className=\"px-4 pt-4 pb-2 shrink-0\"\n                  >\n                    <button\n                      type=\"button\"\n                      onClick={navigateBack}\n                      className=\"flex items-center gap-2 text-sm font-medium text-muted-foreground hover:text-foreground transition-colors cursor-pointer\"\n                      aria-label=\"Navigate back\"\n                    >\n                      <ChevronLeft className=\"w-4 h-4\" />\n                      <span>Back</span>\n                    </button>\n                  </motion.div>\n                )}\n\n                <div className=\"px-1 py-4 max-h-[calc(85vh-4rem)] overflow-y-auto overflow-x-hidden\">\n                  <div className=\"px-3\">{children || <Menu />}</div>\n                </div>\n              </div>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </>\n  );\n}\n\nfunction Menu() {\n  const { currentMenu, direction } = useNestedDrawer();\n\n  const variants = {\n    enter: (dir: \"forward\" | \"backward\") => ({\n      x: dir === \"forward\" ? \"100%\" : \"-100%\",\n      opacity: 0,\n      filter: \"blur(4px)\",\n    }),\n    center: {\n      x: 0,\n      opacity: 1,\n      filter: \"blur(0px)\",\n    },\n    exit: (dir: \"forward\" | \"backward\") => ({\n      x: dir === \"forward\" ? \"-100%\" : \"100%\",\n      opacity: 0,\n      filter: \"blur(4px)\",\n    }),\n  };\n\n  return (\n    <AnimatePresence initial={false} mode=\"popLayout\" custom={direction}>\n      <motion.div\n        key={currentMenu[0]?.id || \"root\"}\n        custom={direction}\n        variants={variants}\n        initial=\"enter\"\n        animate=\"center\"\n        exit=\"exit\"\n        transition={{\n          duration: ANIMATION_DURATION * 0.5,\n          ease: EASING,\n        }}\n        className=\"space-y-1\"\n        role=\"menu\"\n        aria-orientation=\"vertical\"\n      >\n        {currentMenu.map((item) => (\n          <MenuItem key={item.id} item={item} />\n        ))}\n      </motion.div>\n    </AnimatePresence>\n  );\n}\n\ntype TMenuItemProps = {\n  item: TMenuItem;\n};\n\nfunction MenuItem({ item }: TMenuItemProps) {\n  const { navigateToMenu } = useNestedDrawer();\n  const hasChildren = item.children && item.children.length > 0;\n\n  const handleClick = () => {\n    if (hasChildren) {\n      navigateToMenu(item.children!);\n    } else if (item.onClick) {\n      item.onClick();\n    }\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" || e.key === \" \") {\n      e.preventDefault();\n      handleClick();\n    }\n  };\n\n  return (\n    <motion.button\n      type=\"button\"\n      onClick={handleClick}\n      onKeyDown={handleKeyDown}\n      className={cn(\n        \"w-full flex items-start gap-3 px-4 py-3 rounded-lg text-left transition-colors cursor-pointer\",\n        \"hover:bg-accent\",\n        \"focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-0\",\n        \"active:bg-accent/80\"\n      )}\n      role=\"menuitem\"\n      aria-haspopup={hasChildren}\n      tabIndex={0}\n      whileTap={{ scale: 0.98 }}\n      transition={{ duration: 0.1 }}\n    >\n      {item.icon && (\n        <div className=\"shrink-0 mt-1 text-muted-foreground\">{item.icon}</div>\n      )}\n\n      <div className=\"flex-1 min-w-0\">\n        <div className=\"font-medium text-foreground\">{item.title}</div>\n        {item.description && (\n          <div className=\"text-sm text-muted-foreground mt-0.5\">\n            {item.description}\n          </div>\n        )}\n      </div>\n\n      {hasChildren && (\n        <div className=\"shrink-0 text-muted-foreground\">\n          <ChevronRight className=\"w-5 h-5\" />\n        </div>\n      )}\n    </motion.button>\n  );\n}\n\nNestedDrawer.Trigger = Trigger;\nNestedDrawer.Content = Content;\nNestedDrawer.Menu = Menu;\nNestedDrawer.MenuItem = MenuItem;\n",
      "type": "registry:component"
    }
  ],
  "type": "registry:component"
}